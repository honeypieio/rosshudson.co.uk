<!DOCTYPE html>
<html lang="en"><head>
  <meta
    name="google-site-verification"
    content="MlDTC8ydBAgV8T7pPAbPwFIev-DpgKO5VaxT6L6XDqw"
  />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.6.1/css/brands.css"
    integrity="sha384-whKHCkwP9f4MyD1vda26+XRyEg2zkyZezur14Kxc784RxUU1E7HvWVYj9EoJnUV7"
    crossorigin="anonymous"
  />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.6.1/css/fontawesome.css"
    integrity="sha384-WK8BzK0mpgOdhCxq86nInFqSWLzR5UAsNg0MGX9aDaIIrFWQ38dGdhwnNCAoXFxL"
    crossorigin="anonymous"
  />
  <link rel="stylesheet" href="/css/stylesheet.css" />

  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
  />
  <meta name="theme-color" content="#772953" />
  <meta charset="utf-8" />

  <link rel="shortcut icon" type="image/png" href="/favicon.png" />
  <title>Helen Wheels | rosshudson.co.uk</title>
</head>
<body>
    <div class="flex-container">
      <div class="sidebar fixed"><center>
  <a href="https://rosshudson.co.uk" class="text-white">
    <h1 class="sidebar-title text-white">rosshudson.co.uk</h1>
  </a>
  <img src="/images/icon.jpg" class="sidebar-icon" />
  <p class="text-white">A place for stuff to be</p>
  <a
    href="https://twitter.com/hossrudson"
    title="Follow me on twitter!"
    class="no-hover-style"
  >
    <span style="font-size: 3em; color: white;">
      <i class="fab fa-twitter-square"></i>
    </span>
  </a>
  <a
    href="https://github.com/honeypieio"
    title="Check out my GitHub"
    class="no-hover-style"
  >
    <span style="font-size: 3em; color: white;">
      <i class="fab fa-github-square"></i>
    </span>
  </a>
  <p><a href="https://github.com/honeypieio/ubuntu-term">theme</a></p>

</center>

<div class="bottom">
  <p class="tagline" id="tagline"></p>
</div>

<script>
var taglines = [];

  taglines.push("The walrus was Paul")

  taglines.push("\x22It came in a vision â€“ a man appeared on a flaming pie and said unto them, \x27from this day on you are Beatles with an A.\x27\x22")

  taglines.push("The only lonely place is on the moon ðŸŒ™")

  taglines.push("What\x27s yours?")

  taglines.push("The world isn\x27t yours, or an oyster")

  taglines.push("Crooks and grannies")

  taglines.push("Home for tea?")

  taglines.push("Sour milk pee")


document.getElementById("tagline").innerHTML = taglines[Math.floor(Math.random()*taglines.length)];
</script>
</div>
      <div class="content flex-item" style="width:75%;">
        <div class="container" style="padding: 25px;"><p style="margin-bottom: 5px;">
  <b>
    <span class="text-green">guest@<a href="https://rosshudson.co.uk" class="text-green">https://rosshudson.co.uk</a></span><span class="text-white">:</span><span class="text-blue">~</span><span class="text-white" id="path">/helen-wheels/</span></b><span class="text-white">$</span>
     <span class="text-white">ls</span>
</p>
<h1 style="margin-bottom: 0;">Helen Wheels</h1>
		<p class="text-green" style="margin-top: 5px;">2019-02-27</p>
		<div class="text-white" id="content">
				

<p>This project started off with the idea of creating a chatbot that speaks through a typewriter. I&rsquo;ve not got round to making the chatbot part yet, but I probably will in the future. The major hurdle of course was making the typing work.</p>

<p>Here it is booting up:</p>

<video width="50%" controls>
  <source src="/images/helen-wheels/working.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

<h3 id="concept">Concept</h3>

<p>The typewriter I got uses matrix polling to determine what keys to type.</p>

<p>This means that it has two 8 bit buses - a scan bus and a return bus. Each line of the scan bus is &ldquo;probed&rdquo; several times a second. The other circuitry in the typewriter then detects what active scan line(s) are grounded through which return line(s). Essentially, each character you can type corresponds with a combination of lines shorted together.</p>

<h3 id="circuitry">Circuitry</h3>

<p>So in able to simulate these lines being shorted together, I opted to created 2 &ldquo;arrays&rdquo; of N-channel MOSFETs, with their drains and sources commoned together.</p>

<p><img src="/images/helen-wheels/mosfet-configuration.png" /></p>

<p>This meant I could control the current flow between whatever scan and return lines I wanted. To bias (&ldquo;turn on&rdquo;) the MOSFETs, I used two 74HC595N shift registers. I fed the shift registers the data via a Raspberry Pi Zero</p>

<p><img src="/images/helen-wheels/circuitry.jpg" /></p>

<p><small>Note: the resistors are to pulldown any floating grounds</small></p>

<p>On the typewriter&rsquo;s board, I desoldered the edge connector that the original keyboard slotted into and repaced it with standard 0.1&rdquo; male dupont connectors. Then I tapped the rectified side of the main input diode bridge and used a 5v buck converter to power the RPi and the shift registers.</p>

<p><img src="/images/helen-wheels/typewriter-board.jpg" /></p>

<p>Here is all the circuitry put together.</p>

<p><img src="/images/helen-wheels/in-case.jpg" /></p>

<h3 id="code">Code</h3>

<p>I took the membrane out of the keyboard and took photos of each side, as well as the keyboard layout itself. I then put these images into photoshop and traced out what combination of lines corresponded with what keys. From this I created a <a href="https://github.com/honeypieio/helen-wheels/blob/master/type/keymap.py">keymap</a>.</p>

<p>For example the character &ldquo;o&rdquo; has the following lines active on the scan and return buses respectively (represented as two bytes):</p>

<p>00001000
00000100</p>

<p>I then wrote the program that utilises this data.</p>

<p>It iterates through each character in the string to be typed and finds the corresponding bytes from the keymap, then shifts them out to both registers.</p>

<p>I found the optimum keying delay was 0.05 seconds, which is pretty fast!</p>

<p><a href="https://github.com/honeypieio/helen-wheels">Here&rsquo;s the source code if you&rsquo;re interested</a>.</p>

<hr />

<p>Here it is at full speed typing out a test sentence:</p>

<video width="50%" controls>
  <source src="/images/helen-wheels/over-and-over.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

<h3 id="now-what">Now What?</h3>

<p>I have a few ideas on how to use this.
As mentioned before a chatbot is one possibility. That would involve installing a microphone, which can be complicated with a Raspberry Pi as it only has digital inputs&hellip;</p>

<p>Another idea would be using a machine learning corpus to make it automatically type out stupid, made-up poems or movie scripts</p>

<p>Essentially anything that prints to the screen can co-opt the program I&rsquo;ve written to type its output on the typewriter rather than a console or a file.</p>

		</div>

        </div>
      </div>
    </div>
  </body>
  <script>
    var path = document.getElementById("path");
    var pathText = path.textContent;
    var pathMarkup = path.innerHTML;

    splitPath = pathText.split("/")
    splitPath.shift()
    splitPath.pop()


    if(splitPath.length > 1){
      splitPath.pop()
      splitPath.forEach(function(directory){
        console.log(directory)
        var anchor = "<a href=\"https:\/\/rosshudson.co.uk/" + directory + "/\" class=\"inherit-colour\">" + directory + "</a>"

        if(pathMarkup.includes(directory)){
          path.innerHTML = path.innerHTML.replace(directory, anchor)
        }
      })
    }
  </script>
</html>
